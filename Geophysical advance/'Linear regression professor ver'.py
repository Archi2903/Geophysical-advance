'Linear regression'
'Statistical aspects of leaat squares regression'
'Least squares regression is a method to find the best-fitting line through a set of points in a scatter plot.'

'–±–ª–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –∏–º–ø–æ—Ä—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫'
import numpy as np # –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞—Å—Å–∏–≤–∞–º–∏ –∏ –º–∞—Ç—Ä–∏—Ü–∞–º–∏
import matplotlib.pyplot as plt # –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
from sklearn.linear_model import LinearRegression # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
from sklearn.preprocessing import PolynomialFeatures # –¥–ª—è –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
 
import matplotlib.font_manager as fm # –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —à—Ä–∏—Ñ—Ç–∞–º–∏
import matplotlib as mpl # –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å, –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤.

# Ïòà: Windows Í∏∞Î≥∏ ÌïúÍ∏Ä Í∏ÄÍº¥ Ï§ë ÌïòÎÇò ÏÑ§Ï†ï (Malgun Gothic)
plt.rcParams['font.family'] = 'Malgun Gothic' #–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —à—Ä–∏—Ñ—Ç–∞ Malgun Gothic –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —à—Ä–∏—Ñ—Ç–∞ –¥–ª—è –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤.
# –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ—Ä–µ–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö (–≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –º–æ–≥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–≤–∞–¥—Ä–∞—Ç–∏–∫–∏ –∏–ª–∏ –∑–Ω–∞–∫–∏ –≤–æ–ø—Ä–æ—Å–∞).

# ÏùåÏàò Í∏∞Ìò∏ Íπ®Ïßê Î∞©ÏßÄ
mpl.rcParams['axes.unicode_minus'] = False #–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –º–∏–Ω—É—Å (¬´‚àí¬ª) –≤ –æ—Å—è—Ö –≥—Ä–∞—Ñ–∏–∫–∞—Ö, –¥–∞–∂–µ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —à—Ä–∏—Ñ—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç—Ç–æ—Ç —Å–∏–º–≤–æ–ª.
'________________________________________________________________________________________'
"Example 2.1"
'DATA/ –£—Ä–∞–≤–Ω–µ–Ω–∏—è –æ–ø–∏—Å—ã–≤–∞—é—â—é.–ö—Ä–∏–≤—É—é/ –≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –∑–Ω–∞—á'
# –î–∞–Ω–Ω—ã–µ –¥–ª—è –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
t = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]).reshape(-1, 1)  # –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–π –≤ –¥–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ (—á–µ—Ä–µ–∑ reshape)
# –í –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π —Ç—Ä–µ–±—É—é—Ç, —á—Ç–æ–±—ã –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –≤ –≤–∏–¥–µ –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø—Ä–∏–∑–Ω–∞–∫.
y = np.array([109.4, 187.5, 267.5, 331.9, 386.1, 428.4, 452.2, 498.1, 512.3, 513.0]) # y = m1+ m2t -0.5m3t^2 –£—Ä–∞–≤–Ω–µ–Ω–∏—è –æ–ø–∏—Å—ã–≤–∞—é—â—é.–ö—Ä–∏–≤—É—é
# –ü—Ä–∏ —É—Å–ª–æ–≤–∏–∏ —á—Ç–æ mtrue=[10m,100m/s,9.8m/s^2]^T –≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –∑–Ω–∞—á

'–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–≤—Ç–æ—Ä–æ–π —Å—Ç–µ–ø–µ–Ω–∏) —Ä–∞—Å—á–µ—Ç –∏ –≤—ã–≤–æ–¥ matrix G'
'–ü–æ–ª–∏–Ω–æ–º—ã polynomial - –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞,—á—Ç–æ–±—ã –º–æ–¥–µ–ª—å –º–æ–≥–ª–∞ –æ–ø–∏—Å—ã–≤–∞—Ç—å –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –≤—Ö–æ–¥–æ–º –∏ –≤—ã—Ö–æ–¥–æ–º'
poly = PolynomialFeatures(degree=2) 
# –°–æ–∑–¥–∞—ë—Ç—Å—è –æ–±—ä–µ–∫—Ç poly –∫–ª–∞—Å—Å–∞ PolynomialFeatures —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º degree=2, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤—Ç–æ—Ä–æ–π —Å—Ç–µ–ø–µ–Ω–∏.
# –Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫ x, —Ç–æ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –±—É–¥—É—Ç x –∏ x^2.
# –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –º—ã –ø–æ–ª—É—á–∏–º –¥–≤–∞ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞: x –∏ x^2, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –º–æ–¥–µ–ª–∏ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.
t_poly = poly.fit_transform(t)
# fit-–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö (—Ö–æ—Ç—è —Ç—É—Ç —ç—Ç–æ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å) transform-–ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ t –≤ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏.
# –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ t_poly –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–≤–∞ —Å—Ç–æ–ª–±—Ü–∞: –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü - —ç—Ç–æ t, –∞ –≤—Ç–æ—Ä–æ–π - —ç—Ç–æ t^2.
'–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º—É–ª—ã –ø–æ–ª–∏–Ω–æ–º–∞ –≥–¥–µ G=[1, t, -1/2*t^2]'
t_poly_check = t_poly.copy() # –°–æ–∑–¥–∞—ë–º –∫–æ–ø–∏—é t_poly, —á—Ç–æ–±—ã –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤.
t_poly_check[:, 2] *= -0.5 # –£–º–Ω–æ–∂–∞–µ–º —Ç—Ä–µ—Ç–∏–π —Å—Ç–æ–ª–±–µ—Ü (t^2) –Ω–∞ -0.5, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ñ–æ—Ä–º—É–ª—É G=[1, t, -1/2*t^2].
t_poly_check # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ª—É—á–∏–≤—à—É—é—Å—è –º–∞—Ç—Ä–∏—Ü—É t_poly_check. - –≤—ã–≤–æ–¥ –º–∞—Ç—Ä–∏—Ü—ã G
# print (t_poly_check) # –í—ã–≤–æ–¥–∏–º –Ω–∞ —ç–∫—Ä–∞–Ω –ø–æ–ª—É—á–∏–≤—à—É—é—Å—è –º–∞—Ç—Ä–∏—Ü—É t_poly_check.
"""    [  1. ,   1. ,  -0.5],
       [  1. ,   2. ,  -2. ],
       [  1. ,   3. ,  -4.5],
       [  1. ,   4. ,  -8. ],
    G= [  1. ,   5. , -12.5],
       [  1. ,   6. , -18. ],
       [  1. ,   7. , -24.5],
       [  1. ,   8. , -32. ],
       [  1. ,   9. , -40.5],
       [  1. ,  10. , -50. ]
       """

'–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏'
"""–ù–∞—Ö–æ–¥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ü–µ–Ω–∫–∏ –º–∞—Ö –ø—Ä–∞–≤–¥–æ–ø–æ–±–æ–¥–∏—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ Ml2
—Ç–æ –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ—Ç–æ—Ä—ã–µ –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É—é—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∞–±–ª—é–¥–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –¥–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏"""
# ÌöåÍ∑Ä Î™®Îç∏ ÌïôÏäµ –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
model = LinearRegression() # –°–æ–∑–¥–∞—ë—Ç—Å—è –æ–±—ä–µ–∫—Ç LinearRegression() –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ sklearn.linear_model
# y= ax1+bx2+c
model.fit(t_poly, y) # –ú–µ—Ç–æ–¥ .fit(X, y) –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—ã—Ö

# Í≥ÑÏàò Ï∂úÎ†• (-0.5a*t^2 + b*t + c ÌòïÌÉú) –í—ã–≤–æ–¥ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–µ –£—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏: y = a * t¬≤ + b * t + c
m1, m2, m3 = model.intercept_, model.coef_[1], model.coef_[2] #–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –µ–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –º–æ–¥–µ–ª–∏
# model.coef_ ‚Äî –º–∞—Å—Å–∏–≤ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏)
# coef_[2]   = m3 ‚Äî —Ä–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–∏ t^2
# coef_[1]   = m2 ‚Äî —Ä–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–∏ t
# model.intercept_ ‚Äî —Å–≤–æ–±–æ–¥–Ω—ã–π —á–ª–µ–Ω (—Å–≤—è–∑–∞–Ω —Å c)
# intercept_ = m1 ‚Äî –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ (—Å–≤–æ–±–æ–¥–Ω—ã–π —á–ª–µ–Ω)
print(f"m1={m1:.4f}m")
print(f"m2={m2:.4f}m/s")
print(f"m3={m3:.4f}m/s^2")
# print(f"ÌöåÍ∑ÄÏãù(–ü–µ—Ä–≤–∞—è —Ñ–æ—Ä–º–∞ –≤—ã–≤–æ–¥–∞ —É—Ä–∞–≤–Ω–µ–Ω–∏—è): y = {m1:.4f} * t^2 + {m2:.4f} * t + {m3:.4f}") # –ü–µ—Ä–≤–∞—è —Ñ–æ—Ä–º–∞ –≤—ã–≤–æ–¥–∞ —É—Ä–∞–≤–Ω–µ–Ω–∏—è?–Ω—É–∂–Ω–∞ –ª–∏ –æ–Ω–∞
# .4f –æ–∑–Ω–∞—á–∞–µ—Ç –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ 4-—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.
#print('')
# –í—ã–≤–æ–¥–∏—Ç –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É ‚Äî –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –±–ª–æ–∫–æ–≤

# y(t) = m_1 + m_2 t - (1/2)m_3 t^2
print(f"ÍµêÏû¨ regression model:") # –û–ø–∏—Å–∞–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–π —Ñ–æ—Ä–º—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —É—Ä–∞–≤–Ω–µ–Ω–∏—è ‚Äî –∏–∑ —É—á–µ–±–Ω–∏–∫–∞ (ÍµêÏû¨).
print(f"y = {m1:.4f} + {m2:.4f} * t - (1/2) {m3/(-0.5):.4f} * t^2")
print('')
""" 
–ü–æ–ª—É—á–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã mL2 for every parameters m
m1=16.4083m
m2=96.9713m/s
m3=-4.7042m/s^2
ÍµêÏû¨ regression model:
y = 16.4083 + 96.9713 * t - (1/2) 9.4083 * t^2

"______________________________________________________________________________________"
"–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ Regression"
"""

# ÏòàÏ∏°Í∞í Í≥ÑÏÇ∞
t_fit = np.linspace(1, 10, 100).reshape(-1, 1)
# –°–æ–∑–¥–∞—ë—Ç—Å—è 100 —Ç–æ—á–µ–∫ t –æ—Ç 1 –¥–æ 10 (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ), —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö
t_fit_poly = poly.transform(t_fit)
# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º t_fit –≤ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –ø–æ–º–æ—â—å—é —Ä–∞–Ω–µ–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞ poly, –Ω–∞–ø—Ä–∏–º–µ—Ä t->[t^2,t]
y_fit = model.predict(t_fit_poly)
# –ü–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è y –æ—Ç –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è —ç—Ç–∏—Ö –Ω–æ–≤—ã—Ö t-–∑–Ω–∞—á–µ–Ω–∏–π.y=m1t^2+m2t+c
# ÏãúÍ∞ÅÌôî
plt.figure(figsize=(5, 3))  # (Í∞ÄÎ°ú, ÏÑ∏Î°ú) Îã®ÏúÑÎäî Ïù∏Ïπò
plt.scatter(t, y, color='blue', s=10, marker='x', label='Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞(real data)')
plt.plot(t_fit, y_fit, color='red', lw=0.5, label='2Ï∞® ÌöåÍ∑Ä Í≥°ÏÑ† –∫—Ä–∏–≤–∞—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏') # 2Ï∞® ÌöåÍ∑Ä Í≥°ÏÑ†-–∫—Ä–∏–≤–∞—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏(–∏–ª–∏ –≤—Ç–æ—Ä–∞—è —Å—Ç–µ–ø–µ–Ω—å —Ä–µ–≥—Ä–µ—Å—Å–∏–∏)
plt.xlabel('t (s)')
plt.ylabel('y (m)')
plt.title('2Ï∞® Îã§Ìï≠ ÌöåÍ∑Ä (Quadratic Regression) –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è')
plt.legend()
plt.grid(True)
plt.show()

"""
"____________________________________________________"

"Example 2.2" 
"""
"""Goal: –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –ª–∏–Ω–µ–π–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é –≤–∏–¥–∞ y(t)=m1+m2t-0.5m3^2
–∏ –æ—Ü–µ–Ω–∏—Ç—å –¥–æ–≤–µ—Ä–∏–µ –∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º —á–µ—Ä–µ–∑ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É"""

# 1. Îç∞Ïù¥ÌÑ∞ Ï†ïÏùò DATA
t = np.array([1,2,3,4,5,6,7,8,9,10]).reshape(-1,1)
y = np.array([109.4, 187.5, 267.5, 331.9, 386.1, 428.4, 452.2, 498.1, 512.3, 513.0])

# 2. ÎîîÏûêÏù∏ ÌñâÎ†¨ Íµ¨ÏÑ±: [1, t, -0.5 * t^2] –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –≤–∏–¥–∞ G=[1,t,-0.5t^2]
G = np.hstack([       # –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è (horizontal stack) –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–æ–≤ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –º–∞—Å—Å–∏–≤—ã –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º
    np.ones_like(t),  # c (Ï†àÌé∏) —Å–≤–æ–±–æ–¥–Ω—ã–π –°–æ–∑–¥–∞—ë—Ç –º–∞—Å—Å–∏–≤ —Ç–æ–π –∂–µ —Ñ–æ—Ä–º—ã, —á—Ç–æ –∏ t, –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –µ–¥–∏–Ω–∏—Ü–∞–º–∏
    t,                # b Í≥ÑÏàò   –ª–∏–Ω–µ–π–Ω—ã–π
    -0.5 * t**2       # a Í≥ÑÏàòÏôÄ Í≥±Ìï¥Ïßà Ìï≠ —Å —É—á–µ—Ç–æ–º T^2 –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Ñ–æ—Ä–º—É–ª—ã
])

# 3. ÏÑ†Ìòï ÌöåÍ∑Ä Î™®Îç∏ (Ï†àÌé∏ ÏßÅÏ†ë ÎÑ£ÏóàÏúºÎØÄÎ°ú fit_intercept=False)
# –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Å–µ–ø—Ç–∞
model = LinearRegression(fit_intercept=False)
model.fit(G, y) # 
m_L2 = model.coef_ # –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ mL2
print("mL2: ", np.round(m_L2, 2)) # mL2:  [16.41m 96.97m/s 9.41m/s^2]
# 4. ÏïåÎ†§ÏßÑ Ïò§Ï∞® ÌëúÏ§ÄÌé∏Ï∞® –ò–∑–≤–µ—Å—Ç–Ω–∞—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –¥–∞–Ω–Ω—ã—Ö
sigma = 8
sigma_squared = sigma ** 2

# 5. Í≥µÎ∂ÑÏÇ∞ ÌñâÎ†¨ Í≥ÑÏÇ∞ –ö–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
GtG_inv = np.linalg.inv(G.T @ G) # –§–æ—Ä–º—É–ª–∞ Cov[mL2]=(sigma^2)(G^T*G)^-1
cov_m_L2 = sigma_squared * GtG_inv # –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞ –ö–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã

# 6. Í≤∞Í≥º Ï∂úÎ†•
# print("Ï∂îÏ†ïÎêú ÌöåÍ∑Ä Í≥ÑÏàò [m1, m2, m3]:", m_L2)
print("\nÏò§Ï∞® Î∂ÑÏÇ∞ —à—É–º—ã œÉ¬≤ =", sigma_squared)
print("\nÍ≥ÑÏàò Í≥µÎ∂ÑÏÇ∞ ÌñâÎ†¨ –∫–æ–≤–∞—Ä–∏–∞–Ω—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ (Cov[m_L2]):\n", np.round(cov_m_L2, 2))
""" Result
mL2:  [16.41 96.97  9.41]
Ïò§Ï∞® Î∂ÑÏÇ∞ —à—É–º—ã œÉ¬≤ = 64
Í≥ÑÏàò Í≥µÎ∂ÑÏÇ∞ ÌñâÎ†¨ –∫–æ–≤–∞—Ä–∏–∞—Ü–º–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ (Cov[m_L2]):
             [ 88.53 -33.6   -5.33]
 Cov[m_L2] = [-33.6   15.44   2.67]
             [ -5.33   2.67   0.48]
 
"""
"_________________________________________________________________________"
"""Goal: –ü–æ—Å—á–∏—Ç–∞—Ç—å 95% –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
m1,m2,m3 –∏—Å–ø–æ–ª—å–∑—É—è
- –û—Ü–µ–Ω–∫—É –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ mL2
- –ö–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É(cov[mL2])
- –ö–≤–∞–Ω—Ç–∏–ª—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (z = 1.96)
"""
from scipy.stats import norm

# z Í∞í (Ï†ïÍ∑úÎ∂ÑÌè¨ Í∏∞Ï§Ä 95% Ïã†Î¢∞ÏàòÏ§Ä) 
#  –ò–º–ø–æ—Ä—Ç –∫–≤–∞–Ω—Ç–∏–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
z = norm.ppf(0.975)  # ÏïΩ 1.96
# ppf = percent point function (–æ–±—Ä–∞—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫ cdf)
# ùëß ‚âà 1.96 z‚âà1.96 –¥–ª—è 95% –¥–æ–≤–µ—Ä–∏—è (–¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ)

# Ïã†Î¢∞Íµ¨Í∞Ñ Í≥ÑÏÇ∞ –†–∞—Å—á—ë—Ç –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤:
# –§–æ—Ä–º—É–ª–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞: Coef Int = m+-z*se –≥–¥–µ SE - —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞
conf_intervals = []  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞.
for i in range(len(m_L2)):  # –ò—Ç–µ—Ä–∏—Ä—É–µ–º –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (—É –Ω–∞—Å –∏—Ö 3: m1, m2, m3)
    se = np.sqrt(cov_m_L2[i, i])  # —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –æ—Ü–µ–Ω–∫–∏ 
    # (cov_m_L2[i, i]) - –¥–∏—Å–ø–µ—Ä—Å–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
    # se = np.sqrt() - –≤—ã—á–∏—Å–ª—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—à–∏–±–∫—É (SE) –∫–∞–∫ –∫–æ—Ä–µ–Ω—å –∏–∑ –¥–∏—Å–ø–µ—Ä—Å–∏–∏
    lower = m_L2[i] - z * se      # –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞
    upper = m_L2[i] + z * se      # –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞
    conf_intervals.append((lower, upper)) # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤ —Å–ø–∏—Å–æ–∫
print("conf interval",conf_intervals)
"""
   –í—ã–≤–æ–¥ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ—ç—Ñ—Ñ–µ—Ü–∏–µ–Ω—Ç–∞ mL2
   [-2.0334, 34.8501]
   [89.2692, 104.6733]
   [8.0436, 10.7731]
"""
# Í≤∞Í≥º Ï∂úÎ†• –ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Å –ø–æ–¥–ø–∏—Å—è–º–∏ 
labels = ['m_1', 'm_2', 'm_3']  # –ù–∞–∑–≤–∞–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ m1,m2,m3
for i, (ci, est) in enumerate(zip(conf_intervals, m_L2)):
    print(f"{labels[i]} = {est:.4f},  95% Ïã†Î¢∞Íµ¨Í∞Ñ: ({ci[0]:.4f}, {ci[1]:.4f})")
    """
    m_1 = 16.4083,  95% Ïã†Î¢∞Íµ¨Í∞Ñ: (-2.0334, 34.8501)
    m_2 = 96.9713,  95% Ïã†Î¢∞Íµ¨Í∞Ñ: (89.2692, 104.6733)
    m_3 = 9.4083,  95% Ïã†Î¢∞Íµ¨Í∞Ñ: (8.0436, 10.7731)
    Interpretation: 
    –ü—Ä–æ–∏–∑–≤–æ–¥–∏–º 
    - —Ä–∞—Å—á–µ—Ç –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—è –∫–≤–∞–Ω—Ç–∏–ª—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è Z
    - —Ä–∞—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ 
    - –∏—Å–ø–æ–ª—å–∑—É—è —Ä–∞—Å—á–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—à–∏–±–æ–∫ —Ä–∞—Å—á–∏—Ç–≤—ã–≤–∞–µ–º –≥—Ä–∞–Ω–∏—Ü—É –≤–µ—Ä—Ö–Ω–∏—Ö –∏ –Ω–∏–∂–Ω–∏—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ 
    - –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Ä–∞—Å—á–µ–º –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞
    - –≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞—Ö –Ω–∞—à–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å—á–∏—Ç–∞—é—Ç—Å—è –≤–µ—Ä–Ω—ã–º–∏ 
    """

"""Goal: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –º–æ–¥–µ–ª—å —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –æ–±—ä—è—Å–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ,
–ø—Ä–∏ –∑–∞–¥–∞–Ω–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –æ—à–∏–±–æ–∫ ùúé^2, –∏—Å–ø–æ–ª—å–∑—É—è:
- –•–∏-–∫–≤–∞–¥—Ä–∞—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É: œá¬≤ = 
- —Å—Ä–∞–≤–Ω–∏—Ç—å –µ—ë —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º œá¬≤ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Å—Ç–µ–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥—ã (df)
œá¬≤ (chi_squared) - –Ω–∞—Å–∫–æ–ª—å–∫–æ –±–æ–ª—å—à–∞—è –æ—à–∏–±–∫–∞
df (—Å—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±.)	10 - —á–∏—Å–ª–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
p-value	–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É–≤–∏–¥–µ—Ç—å —Ç–∞–∫—É—é –æ—à–∏–±–∫—É —Å–ª—É—á–∞–π–Ω–æ
"""    
from scipy.stats import chi2 # –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç:œá¬≤

# ÏòàÏ∏° Î∞è ÏûîÏ∞® –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∏ –æ—Å—Ç–∞—Ç–∫–∏
y_pred = model.predict(G) # y_pred: –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
residuals = y - y_pred    # residuals: –æ—Å—Ç–∞—Ç–∫–∏ (—Ä–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º–∏)

# Ïπ¥Ïù¥Ï†úÍ≥± ÌÜµÍ≥ÑÎüâ Í≥ÑÏÇ∞: RSS / sigma^2 –í—ã–±–æ—Ä –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –∏ —Ä–∞—Å—á—ë—Ç RSS(—Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –æ—à–∏–±–æ–∫)
sigma = 8
RSS = np.sum(residuals**2)
chi_squared = RSS / (sigma**2)

# ÏûêÏú†ÎèÑ –°—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã v=m-n
df = len(y) - G.shape[1]  # 10 - 3 = 7

# p-value Í≥ÑÏÇ∞ (Ïö∞Ï∏° ÎàÑÏ†Å ÌôïÎ•†) –†–∞—Å—á—ë—Ç p-value
p_value = 1 - chi2.cdf(chi_squared, df=df)
# chi_squared-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∞–±–ª—é–¥–∞—Ç—å –º–µ–Ω—å—à–µ–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
# 1 - cdf ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∞–±–ª—é–¥–∞—Ç—å –±–æ–ª—å—à–µ ‚Üí —Ç–æ –µ—Å—Ç—å –Ω–∞—à–∞ p-value
# –ï—Å–ª–∏ p-value < 0.05  p-value  0.05 ‚Üí –º–æ–¥–µ–ª—å –Ω–µ –æ–±—ä—è—Å–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ö–æ—Ä–æ—à–æ (–≥–∏–ø–æ—Ç–µ–∑–∞ –æ–± –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç—Å—è)

# Ï∂úÎ†•  –í—ã–≤–æ–¥
print(f"Chi-squared statistic: {chi_squared:.4f}")
print(f"Degrees of freedom: {df}")
print(f"p-value: {p_value:.4e}")
"–ï—Å–ª–∏ p-value < 0.05  p-value  0.05 ‚Üí –º–æ–¥–µ–ª—å –Ω–µ –æ–±—ä—è—Å–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ö–æ—Ä–æ—à–æ (–≥–∏–ø–æ—Ç–µ–∑–∞ –æ–± –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç—Å—è)"
"""
œá¬≤: 4.1810
Degrees of freedom(df): 7
p-value: 7.5871e-01    
"""
"_________________________________________________________________________"

"Example 2.2: Confidence ellipsoid"

"""Goal: –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –º–µ–∂–¥—É –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏ –º–æ–¥–µ–ª–∏: ùëö1,ùëö2,ùëö3
–æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –∏—Ö –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ
–ü–æ—Å—Ç—Ä–æ–∏—Ç—å —ç–ª–ª–∏–ø—Å–æ–∏–¥ –¥–æ–≤–µ—Ä–∏—è –¥–ª—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ m1,m2,m3   """
import pandas as pd

# ÌëúÏ§ÄÌé∏Ï∞® Î≤°ÌÑ∞ (Í∞Å Í≥ÑÏàòÏùò standard error)
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ä–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ stand_error=sqrt(Var(m))
# Cov[mL2]=(sigma^2)(G^T*G)^-1
std_errors = np.sqrt(np.diag(cov_m_L2)) # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
# np.diag(cov_m_L2) - –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã cov_m_L2
# np.sqrt - –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å –∏–∑ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
# std_errors = [sqrt(cov_m_L2[0,0]), sqrt(cov_m_L2[1,1]), sqrt(cov_m_L2[2,2])]

# ÏÉÅÍ¥ÄÍ≥ÑÏàò ÌñâÎ†¨ Í≥ÑÏÇ∞ –§–æ—Ä–º—É–ª–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –¥–∞–Ω–æ –≤ —É—á–µ–±–Ω–∏–∫–µ
corr_matrix = cov_m_L2 / (std_errors[:, None] * std_errors[None, :]) # —Ñ–æ—Ä–º—É–ª—ã –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ Corr[mi:mj]=(Cov[mL2])/(stdErrorsi*stdErrorsj)
# std_errors[:, None] - –¥–µ–ª–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä —Å—Ç–æ–ª–±—Ü–æ–º
# std_errors[None, :] - –¥–µ–ª–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä —Å—Ç—Ä–æ–∫–æ–π
"‚Üí –∏—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –¥–∞—ë—Ç –º–∞—Ç—Ä–∏—Ü—É —Ä–∞–∑–º–µ—Ä–æ–º (3√ó3), –ø—Ä–∏–≥–æ–¥–Ω—É—é –¥–ª—è –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–≥–æ –¥–µ–ª–µ–Ω–∏—è –≤—Å–µ–π cov_m_L2"
corr_df = pd.DataFrame(corr_matrix, index=labels, columns=labels)
# pd.DataFrame(...) –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç NumPy-–º–∞—Å—Å–∏–≤ –≤ —á–∏—Ç–∞–±–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É

# Í≤∞Í≥º Ï∂úÎ†•
labels = ['m_1', 'm_2', 'm_3']
print(std_errors.round(2))
print("Í≥ÑÏàò ÏÉÅÍ¥ÄÍ≥ÑÏàò ÌñâÎ†¨(Correlation coefficient matrix):")
print(corr_df.round(4))  # ÏÜåÏàòÏ†ê 4ÏûêÎ¶¨ÍπåÏßÄ Î≥¥Í∏∞ Ï¢ãÍ≤å Ï∂úÎ†•(–æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ 4 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)
"""    m_1     m_2     m_3
m_1  1.0000 -0.9087 -0.8140
m_2 -0.9087  1.0000  0.9746
m_3 -0.8140  0.9746  1.0000      """
"""Interpretation:
–í—ã–≤–µ–¥–µ–Ω–Ω–∞—è –ö–æ—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ m1,m2,m3
- –ø–æ–ª—É—á–µ–Ω–Ω–∞—è –∏–∑ —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—à–∏–±–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ m [9.41 3.93 0.7 ]
- –ø–æ–ª—É—á–µ–Ω–Ω–∞—è –∏–∑ —Ñ–æ—Ä–º—É–ª—ã –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ Corr[m:m]=(Cov[mL2])/(stdErrorsi*stdErrorsj)
–ü–æ–ª—É—á–µ–Ω–∞–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–∞–∑—ã–≤–∞–µ—Ç p ‚àà[-1,1] 1 = —Å–∏–ª—å–Ω–∞—è –ø–æ–ª–æ–∂. —Å–≤—è–∑—å, 0 = –Ω–µ—Ç —Å–≤—è–∑–∏, -1 = –æ—Ç—Ä–∏—Ü. —Å–≤—è–∑—å
–î–∏–∞–≥–æ–Ω–∞–ª—å –≤—Å–µ–≥–¥–∞ = 1 -> –∫–∞–∂–¥—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω —Å–∞–º —Å —Å–æ–±–æ–π –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –±–ª–∏–∑–∫–∏ –∫ ¬±1 ‚Äî –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω—ã
"""
"____________________________________________________________________________________________"
"Goal: –í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–∏–∞–≥–æ–Ω–æ–ª–∏–∑–∞—Ü–∏—é(—Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ)–æ–±—Ä–∞—Ç–Ω–æ–π –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã"
"""
- –≤ –∫–∞–∫–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ª—É—á—à–µ/—Ö—É–∂–µ —á–µ—Ä–µ–∑  –≥–µ–æ–º–µ—Ç—Ä–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ (—á–µ—Ä–µ–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è/–≤–µ–∫—Ç–æ—Ä—ã)
- —É–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—É—é —Ñ–æ—Ä–º—É–ª—É A=QŒõQ^-1
- –∫–∞–∫ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏ –≤—ã–≥–ª—è–¥–∏—Ç –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å
"""
# Í≥µÎ∂ÑÏÇ∞ ÌñâÎ†¨Ïùò Ïó≠ÌñâÎ†¨ Inverse covvariotionate matrix –ù–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ–π (information matrix)
inv_cov = np.linalg.inv(cov_m_L2) 
# inv_cov ‚Äî –µ—ë –æ–±—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ Cov^-1

# Ïó≠ÌñâÎ†¨Ïùò Í≥†Ïú†Í∞í Î∂ÑÌï¥ (diagonalization) –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—É—é —Ñ–æ—Ä–º—É–ª—É A=QŒõQ^-1
eigvals, eigvecs = np.linalg.eig(inv_cov)
# eigvals ‚ÜíŒõ: –º–∞—Å—Å–∏–≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
# eigvecs ‚ÜíQ: –º–∞—Ç—Ä–∏—Ü–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤

# Í≥†Ïú†Í∞í Ïò§Î¶ÑÏ∞®Ïàú Ï†ïÎ†¨ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
idx = np.argsort(eigvals) # argsort - —ç—Ç–æ 
eigvals_sorted = eigvals[idx]
eigvecs_sorted = eigvecs[:, idx]
# eigvecs_sorted ‚Äî –ø–µ—Ä–µ—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç–æ–ª–±—Ü—ã –≤ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ

# Ï†ïÎ†¨Îêú Í≥†Ïú†Í∞í/Í≥†Ïú†Î≤°ÌÑ∞Î°ú Ïó≠ÌñâÎ†¨ Î≥µÏõê –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –ø–æ —Ñ–æ—Ä–º—É–ª–µ A=QŒõQ^-1
reconstructed_sorted = eigvecs_sorted @ np.diag(eigvals_sorted) @ np.linalg.inv(eigvecs_sorted)

# Ï∂úÎ†• (ÏòàÏÅòÍ≤å Î≥¥Í∏∞ ÏúÑÌï¥ ÏòµÏÖò ÏÑ§Ï†ï)
np.set_printoptions(precision=4, suppress=True)
print('')
print("Ïó≠ÌñâÎ†¨[–ò—Å—Ö–æ–¥–Ω—É—é](Cov‚Åª¬π):\n", inv_cov)
print('')
print("Ï†ïÎ†¨Îêú Í≥†Ïú†Í∞í[–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è](Œõ):\n", eigvals_sorted)
print('')
print("\nÏ†ïÎ†¨Îêú Í≥†Ïú†Î≤°ÌÑ∞ ÌñâÎ†¨[–ú–∞—Ç—Ä–∏—Ü—É —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤](Q):\n", eigvecs_sorted)
print('')
print("\nQ Œõ Q‚Åª¬π Î≥µÏõê Í≤∞Í≥º (Ï†ïÎ†¨Îêú Í≥†Ïú†Í∞í Í∏∞Ï§Ä)[–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É]:\n", reconstructed_sorted)
"""
Result
Ïó≠ÌñâÎ†¨[–ò—Å—Ö–æ–¥–Ω—É—é](Cov‚Åª¬π):
 [[  0.1562   0.8594  -3.0078]
 [  0.8594   6.0156 -23.6328]
 [ -3.0078 -23.6328  98.957 ]]
Ï†ïÎ†¨Îêú Í≥†Ïú†Í∞í[–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è](Œõ):
 [  0.0098   0.4046 104.7145]

Ï†ïÎ†¨Îêú Í≥†Ïú†Î≤°ÌÑ∞ ÌñâÎ†¨[–ú–∞—Ç—Ä–∏—Ü—É —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤](Q):
 [[-0.93    0.3663 -0.0299]
 [ 0.3629  0.9022 -0.233 ]
 [ 0.0584  0.2275  0.972 ]]

Q Œõ Q‚Åª¬π Î≥µÏõê Í≤∞Í≥º (Ï†ïÎ†¨Îêú Í≥†Ïú†Í∞í Í∏∞Ï§Ä)[–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É]:
 [[  0.1562   0.8594  -3.0078]
 [  0.8594   6.0156 -23.6328]
 [ -3.0078 -23.6328  98.957 ]]
 Interpretation:
 - –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã(eigvecsQ) –¥–∞—é—Ç –≥–ª–∞–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏.
 - –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è(eigvalsŒõ) ‚Äî –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è "—á—ë—Ç–∫–æ—Å—Ç—å") –≤ —ç—Ç–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö.
 –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
- –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —ç–ª–ª–∏–ø—Å–æ–∏–¥–æ–≤,
- PCA, SVD,
- –±–∞–π–µ—Å–æ–≤—Å–∫–æ–π –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏.
 """
 
"Goals: –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π —ç–ª–ª–∏–ø—Å–æ–∏–¥ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ m=[m1,m2,m3]–Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã. –≠—Ç–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ –æ—Ü–µ–Ω–∫–∏." 
# Ïã†Î¢∞ÏàòÏ§Ä (95%)Ïóê Ìï¥ÎãπÌïòÎäî Ïπ¥Ïù¥Ï†úÍ≥± Î∂ÑÏúÑÍ∞í –ó–Ω–∞—á–µ–Ω–∏–µ –∫–≤–∞–Ω—Ç–∏–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–º—É —É—Ä–æ–≤–Ω—é (95%)
p = 3  # Í≥ÑÏàò Í∞úÏàò —á–∏—Å–ª–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –º–æ–¥–µ–ª–∏ (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞)
chi2_val = chi2.ppf(0.95, df=p) # 95%-–∫–≤–∞–Ω—Ç–∏–ª—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è œá¬≤ —Å 3 —Å—Ç–µ–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥—ã
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π

# 95% Ïã†Î¢∞ ÌÉÄÏõêÏ≤¥Ïùò Î∞òÏ∂ï Í∏∏Ïù¥ (semiaxis) –î–ª–∏–Ω—ã –ø–æ–ª—É–æ—Å–µ–π (semiaxis) —ç–ª–ª–∏–ø—Å–æ–∏–¥–∞ –¥–æ–≤–µ—Ä–∏—è 95%
semiaxes = np.sqrt(chi2_val / eigvals_sorted)
# eigvals_sorted ‚Äî —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã



# Ï∂úÎ†•
np.set_printoptions(precision=4, suppress=True)
print('')
print("Í≥†Ïú†Í∞í (Ïò§Î¶ÑÏ∞®Ïàú)–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ùúÜùëñ:", eigvals_sorted)
print("95% Ïã†Î¢∞ÏàòÏ§Ä Chi¬≤ –ö–≤–∞–Ω—Ç–∏–ª—å œá¬≤ (–≥—Ä–∞–Ω–∏—Ü–∞ —ç–ª–ª–∏–ø—Å–æ–∏–¥–∞) Í∞í:", chi2_val)
print("Ïã†Î¢∞ ÌÉÄÏõêÏ≤¥Ïùò Î∞òÏ∂ï Í∏∏Ïù¥ (semiaxes)–ü–æ–ª—É–¥–ª–∏–Ω—ã –æ—Å–µ–π —ç–ª–ª–∏–ø—Å–æ–∏–¥–∞ –≤–¥–æ–ª—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π:", semiaxes)
""" 
Í≥†Ïú†Í∞í (Ïò§Î¶ÑÏ∞®Ïàú)–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ùúÜùëñ: [  0.0098   0.4046 104.7145]
95% Ïã†Î¢∞ÏàòÏ§Ä Chi¬≤ –ö–≤–∞–Ω—Ç–∏–ª—å œá¬≤ (–≥—Ä–∞–Ω–∏—Ü–∞ —ç–ª–ª–∏–ø—Å–æ–∏–¥–∞) Í∞í: 7.814727903251176
Ïã†Î¢∞ ÌÉÄÏõêÏ≤¥Ïùò Î∞òÏ∂ï Í∏∏Ïù¥ (semiaxes)–ü–æ–ª—É–¥–ª–∏–Ω—ã –æ—Å–µ–π —ç–ª–ª–∏–ø—Å–æ–∏–¥–∞ –≤–¥–æ–ª—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π: [28.2301  4.395   0.2732]
Interpretation:
–≠—Ç–æ—Ç –∫–æ–¥ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä—ã –ø–æ–ª—É–æ—Å–µ–π –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ —ç–ª–ª–∏–ø—Å–æ–∏–¥–∞ (–Ω–∞ 95% –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ) –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ m1,m2,m3
- –≠–ª–ª–∏–ø—Å–æ–∏–¥ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ m1,m2,m3 –û–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –≤ –∫–∞–∫–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö –º–æ–¥–µ–ª—å –Ω–∞–∏–±–æ–ª–µ–µ/–Ω–∞–∏–º–µ–Ω–µ–µ —É–≤–µ—Ä–µ–Ω–∞.
- –ü–æ–ª—É–æ—Å–∏: –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å—Ç–µ–ø–µ–Ω—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ –≤–¥–æ–ª—å –≥–ª–∞–≤–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- –î–ª–∏–Ω–∞ –æ—Å–∏
- –≠–ª–ª–∏–ø—Å–æ–∏–¥ —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –æ–±—Ä–∞—Ç–Ω–æ–π –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã.
"""
"____________________________________________________________________________________________________________________"

"Goals plot,vizualization"
import matplotlib.gridspec as gridspec

# Íµ¨Î©¥ ÏÉùÏÑ±
u = np.linspace(0, 2 * np.pi, 50)
v = np.linspace(0, np.pi, 50)
x = np.outer(np.cos(u), np.sin(v))
y = np.outer(np.sin(u), np.sin(v))
z = np.outer(np.ones_like(u), np.cos(v))
sphere = np.stack([x, y, z], axis=-1).reshape(-1, 3)

# ÌöåÏ†Ñ, Ïä§ÏºÄÏùº, Ïù¥Îèô
trans_axes = eigvecs_sorted @ np.diag(semiaxes)
ellipsoid = (trans_axes @ sphere.T).T + m_L2

# Ìà¨ÏòÅ
projections = [
    (ellipsoid[:, 0], ellipsoid[:, 1]),  # m1-m2
    (ellipsoid[:, 0], ellipsoid[:, 2]),  # m1-m3
    (ellipsoid[:, 1], ellipsoid[:, 2])   # m2-m3
]
labels = [('$m_1$', '$m_2$'), ('$m_1$', '$m_3$'), ('$m_2$', '$m_3$')]
lims = [[-50, 50, 85, 110], [-50, 50, 7, 12], [80, 120, 7, 12]]
colors = ['r', 'b', 'g']

# GridSpecÏúºÎ°ú 2:1:1:1 ÎπÑÏú® subplot Î∞∞Ïπò
fig = plt.figure(figsize=(15, 6))
gs = gridspec.GridSpec(1, 4, width_ratios=[2, 1, 1, 1], figure=fig)

# 3D Plot
ax3d = fig.add_subplot(gs[0], projection='3d')
ax3d.scatter(ellipsoid[:, 1], ellipsoid[:, 0], np.full_like(ellipsoid[:, 2], 7),
             s=0.5, color='r', alpha=0.2, label='(m1,m2)')
ax3d.scatter(np.full_like(ellipsoid[:, 1], 80), ellipsoid[:, 0], ellipsoid[:, 2],
             s=0.5, color='b', alpha=0.2, label='(m1,m3)')
ax3d.scatter(ellipsoid[:, 1], np.full_like(ellipsoid[:, 0], -50), ellipsoid[:, 2],
             s=0.5, color='g', alpha=0.2, label='(m2,m3)')
ax3d.scatter(ellipsoid[:, 1], ellipsoid[:, 0], ellipsoid[:, 2],
             s=0.5, color='gray', alpha=0.05, label="Ellipsoid")

ax3d.set_ylabel('$m_1$ (m)')
ax3d.set_xlabel('$m_2$ (m/s)')
ax3d.set_zlabel('$m_3$ (m/s¬≤)')
ax3d.set_ylim(-50, 50)
ax3d.set_xlim(110, 80)
ax3d.set_zlim(7, 12)
ax3d.view_init(elev=30, azim=115)
ax3d.set_box_aspect((1, 1, 1.7))
ax3d.legend(markerscale=10)

# 2D ÌèâÎ©¥ Ïä¨ÎùºÏù¥Ïä§
for i, (proj, (lx, ly), lim, color) in enumerate(zip(projections, labels, lims, colors), start=1):
    ax = fig.add_subplot(gs[i])
    ax.scatter(proj[0], proj[1], s=0.5, color=color, alpha=0.5)
    ax.set_xlabel(lx)
    ax.set_ylabel(ly)
    ax.set_xlim(lim[0], lim[1])
    ax.set_ylim(lim[2], lim[3])

plt.tight_layout()
plt.show()

""
# semiaxis lengthÎ•º ÌöåÍ∑ÄÏ¢åÌëúÍ≥ÑÎ°ú Î≥ÄÌôò
semiaxes_matrix = np.diag(semiaxes)
semiaxis_vectors = eigvecs_sorted @ semiaxes_matrix

# Ï∂úÎ†•
np.set_printoptions(precision=4, suppress=True)
print("ÌöåÍ∑ÄÏ¢åÌëúÍ≥ÑÏóêÏÑúÏùò ÌÉÄÏõê[–≠–ª–ª–∏–ø—Å –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö —Ä–µ–≥—Ä–µ—Å—Å–∏–∏]:\n", semiaxis_vectors)
""" 
ÌöåÍ∑ÄÏ¢åÌëúÍ≥ÑÏóêÏÑúÏùò ÌÉÄÏõê[–≠–ª–ª–∏–ø—Å –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö —Ä–µ–≥—Ä–µ—Å—Å–∏–∏]:
 [[-26.254    1.6101  -0.0082]
 [ 10.2445   3.9653  -0.0637]
 [  1.6488   1.       0.2655]]
–í–µ–∫—Ç–æ—Ä, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–¥–∏—É—Å–∞ —Å–∞–º–æ–π –¥–ª–∏–Ω–Ω–æ–π –æ—Å–∏ —ç–ª–ª–∏–ø—Å–æ–∏–¥–∞ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª–æ–≤–∏–Ω–µ —à–∏—Ä–∏–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ (bounding box).
–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –ø–µ—Ä–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ –º–∞—Ç—Ä–∏—Ü—ã ùëÉ‚ãÖdiag(eigenvalues)
P‚ãÖdiag(eigenvalues) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–æ–≤–∏–Ω—É –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞.
"""

# Ïã†Î¢∞Íµ¨Í∞Ñ Í≥ÑÏÇ∞
se = semiaxis_vectors[:,0]
conf_intervals = []
for i in range(len(m_L2)):
    lower = m_L2[i] - abs(se[i])
    upper = m_L2[i] + abs(se[i])
    conf_intervals.append((lower, upper))

labels = ['m_1', 'm_2', 'm_3']
for i, (ci, est) in enumerate(zip(conf_intervals, m_L2)):
    print(f"{labels[i]} = {est:.4f},  95% Ïã†Î¢∞Íµ¨Í∞Ñ: ({ci[0]:.4f}, {ci[1]:.4f})")
""" 
m_1 = 16.4083,  95% Ïã†Î¢∞Íµ¨Í∞Ñ: (-9.8456, 42.6623)
m_2 = 96.9713,  95% Ïã†Î¢∞Íµ¨Í∞Ñ: (86.7267, 107.2158)
m_3 = 9.4083,  95% Ïã†Î¢∞Íµ¨Í∞Ñ: (7.7596, 11.0571)
"""